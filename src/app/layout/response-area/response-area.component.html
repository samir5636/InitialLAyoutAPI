<div class="response-container">
  <div *ngIf="statusCode === 0 && !responseData" class="no-response">
    <p>Send a request to see the response here</p>
  </div>

  <div *ngIf="statusCode !== 0 || responseData" class="response-content">
    <!-- Response Status and Metadata -->
    <div class="response-header">
      <div class="status-container" [ngClass]="{
        'success': statusCode >= 200 && statusCode < 300,
        'redirect': statusCode >= 300 && statusCode < 400,
        'client-error': statusCode >= 400 && statusCode < 500,
        'server-error': statusCode >= 500,
        'error': statusCode < 200 && statusCode !== 0}">
        <span class="status-code">{{ statusCode !== 0 ? statusCode : 'ERR' }}</span>
        <span class="status-text">{{ statusText }}</span>
      </div>

      <div class="response-meta">
        <span class="time" title="Response Time">{{ responseTime }} ms</span>
        <span class="size" title="Response Size">{{ responseSize }} B</span>
      </div>
    </div>

    <!-- Response Data Tabs -->
    <mat-tab-group animationDuration="0ms">
      <!-- Body Tab -->
      <mat-tab label="Body" [disabled]="!formattedBody && statusCode !== 204">
        <div class="tab-content">
          <div *ngIf="formattedBody || statusCode === 204" class="editor-container">
            <!-- Show editor even for 204 to display the "204 No Content" message if formattedBody is set to it -->
            <ngx-monaco-editor [options]="editorOptions" [(ngModel)]="formattedBody"></ngx-monaco-editor>
          </div>
          <div *ngIf="!formattedBody && statusCode !== 0 && statusCode !== 204" class="no-data">
            <!-- Message for truly empty bodies that are not 204 -->
            <p *ngIf="statusCode >= 200 && statusCode < 300">Response body is empty.</p>
            <p *ngIf="statusCode >= 300 || (statusCode < 200 && statusCode !==0)">This response type typically does not include a body or an error occurred processing it.</p>
          </div>
        </div>
      </mat-tab>

      <!-- Headers Tab -->
      <mat-tab label="Headers" [disabled]="responseHeaders.length === 0">
        <div class="tab-content">
          <table class="key-value-table" *ngIf="responseHeaders.length > 0">
            <thead>
            <tr>
              <th>Header</th>
              <th>Value</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let header of responseHeaders">
              <td>{{ header.key }}</td>
              <td>{{ header.value }}</td>
            </tr>
            </tbody>
          </table>
          <div *ngIf="responseHeaders.length === 0" class="no-data">No headers found.</div>
        </div>
      </mat-tab>

      <!-- Cookies Tab -->
      <mat-tab label="Cookies" [disabled]="cookies.length === 0">
        <div class="tab-content">
          <table class="key-value-table" *ngIf="cookies.length > 0">
            <thead>
            <tr>
              <th>Name</th>
              <th>Value</th>
              <th>Properties</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let cookie of cookies">
              <td>{{ cookie.name }}</td>
              <td>{{ cookie.value }}</td>
              <td>
                <ng-container *ngIf="cookie.properties && ((cookie.properties | keyvalue) ?? []).length > 0">
                  <div *ngFor="let prop of cookie.properties | keyvalue" class="cookie-property">
                    <span class="cookie-prop-key">{{ prop.key }}:</span>
                    <span class="cookie-prop-value">{{ prop.value }}</span>
                  </div>
                </ng-container>
                <span *ngIf="!cookie.properties || ((cookie.properties | keyvalue) ?? []).length === 0">-</span>
              </td>
            </tr>
            </tbody>
          </table>
          <div *ngIf="cookies.length === 0" class="no-data">No cookies found.</div>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>
